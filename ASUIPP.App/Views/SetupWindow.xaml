<Window x:Class="ASUIPP.App.Views.SetupWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="АСУИПП — Первоначальная настройка"
        Width="550" Height="500"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        Background="#C0C0C0">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Заголовок -->
        <TextBlock Grid.Row="0" Text="Первоначальная настройка АСУИПП"
                   FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>

        <!-- Шаг 1: Excel -->
        <TextBlock Grid.Row="1" Text="1. Загрузите файл Excel с показателями:" Margin="0,0,0,5"/>

        <DockPanel Grid.Row="2" Margin="0,0,0,10">
            <Button DockPanel.Dock="Right" Content="Обзор..." Width="80" Margin="10,0,0,0"
                    Command="{Binding BrowseExcelCommand}"/>
            <TextBox IsReadOnly="True"
                     Text="{Binding ExcelFilePath, Mode=OneWay}"
                     VerticalContentAlignment="Center"
                     Padding="5,3"/>
        </DockPanel>

        <!-- Семестр -->
        <TextBlock Grid.Row="3"
                   Text="{Binding SemesterDisplay}"
                   FontStyle="Italic" Margin="0,0,0,10"
                   Visibility="{Binding IsExcelLoaded, Converter={StaticResource BoolToVisibility}}"/>

        <!-- Шаг 2: Кафедра -->
        <TextBlock Grid.Row="4" Text="2. Выберите кафедру:" Margin="0,0,0,5"
                   Visibility="{Binding IsExcelLoaded, Converter={StaticResource BoolToVisibility}}"/>

        <ComboBox Grid.Row="5" Margin="0,0,0,10"
                  ItemsSource="{Binding Departments}"
                  SelectedItem="{Binding SelectedDepartment}"
                  DisplayMemberPath="FullName"
                  Visibility="{Binding IsExcelLoaded, Converter={StaticResource BoolToVisibility}}"/>

        <!-- Шаг 3: ФИО и роль -->
        <StackPanel Grid.Row="6" Margin="0,0,0,10"
                    Visibility="{Binding IsExcelLoaded, Converter={StaticResource BoolToVisibility}}">

            <TextBlock Text="3. Ваши данные:" Margin="0,0,0,5"/>

            <DockPanel Margin="0,0,0,8">
                <TextBlock DockPanel.Dock="Left" Text="ФИО:" Width="60" VerticalAlignment="Center"/>
                <TextBox Text="{Binding FullName, UpdateSourceTrigger=PropertyChanged}"
                         Padding="5,3"/>
            </DockPanel>

            <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                <TextBlock Text="Роль:" Width="60" VerticalAlignment="Center"/>
                <RadioButton Content="Преподаватель"
                             IsChecked="{Binding IsHead, Converter={StaticResource InvertBool}}"
                             Margin="0,0,15,0" VerticalAlignment="Center"/>
                <RadioButton Content="Заведующий кафедрой"
                             IsChecked="{Binding IsHead}"
                             VerticalAlignment="Center"/>
            </StackPanel>
        </StackPanel>

        <!-- Статус -->
        <TextBlock Grid.Row="8" Text="{Binding StatusText}"
                   Foreground="Gray" Margin="0,10,0,10" TextWrapping="Wrap"/>

        <!-- Кнопка -->
        <Button Grid.Row="9" Content="Начать работу"
                Height="35" FontSize="14"
                Command="{Binding FinishCommand}"
                HorizontalAlignment="Right" Width="150"/>
    </Grid>
</Window>